# Bus Kiosk Backend - Production Environment Variables
# Copy this file to .env and configure your production values
# This file is used by the CD pipeline (deploy.sh) and docker-compose.prod.yml

# =============================================================================
# DJANGO CORE SETTINGS
# =============================================================================

# Django Secret Key (MUST be changed in production)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(50))"
SECRET_KEY=your-50-character-django-secret-key-here

# Debug mode (MUST be False in production)
DEBUG=False

# Allowed hosts (comma-separated, no spaces)
ALLOWED_HOSTS=yourdomain.com,www.yourdomain.com,api.yourdomain.com

# Encryption key for sensitive data (32 bytes, base64 encoded)
# Generate with: python -c "import secrets; import base64; print(base64.b64encode(secrets.token_bytes(32)).decode())"
ENCRYPTION_KEY=your-32-byte-base64-encoded-encryption-key

# =============================================================================
# DATABASE SETTINGS
# =============================================================================

# PostgreSQL Database Configuration
DB_ENGINE=django.db.backends.postgresql
DB_NAME=bus_kiosk_prod
DB_USER=bus_kiosk_user
DB_PASSWORD=your-secure-database-password-here
DB_HOST=db
DB_PORT=5432

# Database connection pool settings
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30

# =============================================================================
# REDIS SETTINGS
# =============================================================================

# Redis Configuration
REDIS_URL=redis://redis:6379/0
REDIS_PASSWORD=  # Leave empty if no password

# Separate Redis databases for different purposes
REDIS_CACHE_URL=redis://redis:6379/1
REDIS_SESSION_URL=redis://redis:6379/2

# =============================================================================
# CELERY SETTINGS
# =============================================================================

# Celery broker and result backend
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0

# Celery configuration
CELERY_WORKERS=2
CELERY_TASK_SOFT_TIME_LIMIT=300
CELERY_TASK_TIME_LIMIT=600

# =============================================================================
# DOCKER REGISTRY
# =============================================================================

# Docker Hub username (for pulling images in CD pipeline)
DOCKER_USERNAME=your-dockerhub-username

# =============================================================================
# SECURITY & CORS
# =============================================================================

# CORS settings
CORS_ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com
CORS_ALLOW_CREDENTIALS=True

# Security headers
SECURE_SSL_REDIRECT=True
SECURE_HSTS_SECONDS=31536000
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True
SECURE_REFERRER_POLICY=strict-origin-when-cross-origin
X_FRAME_OPTIONS=DENY

# Session and CSRF settings
SESSION_COOKIE_SECURE=True
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=Lax
CSRF_COOKIE_SECURE=True
CSRF_COOKIE_SAMESITE=Lax

# =============================================================================
# EMAIL SETTINGS (Optional)
# =============================================================================

# SMTP Configuration
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@gmail.com
EMAIL_HOST_PASSWORD=your-app-password
DEFAULT_FROM_EMAIL=noreply@yourdomain.com

# =============================================================================
# MONITORING & LOGGING
# =============================================================================

# Sentry for error monitoring
SENTRY_DSN=https://your-sentry-dsn-here
SENTRY_ENVIRONMENT=production

# Prometheus metrics
PROMETHEUS_METRICS_ENABLED=True

# Logging configuration
LOG_LEVEL=INFO
LOG_FORMAT=json

# =============================================================================
# PERFORMANCE SETTINGS
# =============================================================================

# Gunicorn settings
GUNICORN_WORKERS=3
GUNICORN_THREADS=2
GUNICORN_TIMEOUT=30
GUNICORN_KEEPALIVE=10

# Cache settings
CACHE_MIDDLEWARE_SECONDS=300
CACHE_KEY_PREFIX=bus_kiosk_prod

# Static files
STATIC_URL=/static/
STATIC_ROOT=/app/staticfiles
MEDIA_URL=/media/
MEDIA_ROOT=/app/media

# =============================================================================
# NGINX SETTINGS
# =============================================================================

# Nginx server configuration
NGINX_SERVER_NAME=yourdomain.com www.yourdomain.com

# SSL certificate paths (for custom certificates)
NGINX_SSL_CERT_PATH=/etc/ssl/certs/yourdomain.crt
NGINX_SSL_KEY_PATH=/etc/ssl/private/yourdomain.key

# Rate limiting
NGINX_RATE_LIMIT_API=10r/s
NGINX_RATE_LIMIT_AUTH=5r/m

# =============================================================================
# BACKUP SETTINGS
# =============================================================================

# Database backup configuration
BACKUP_ENABLED=True
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE=local

# =============================================================================
# HEALTH CHECK SETTINGS
# =============================================================================

# Health check endpoints
HEALTH_CHECK_ENABLED=True
HEALTH_CHECK_DATABASE=True
HEALTH_CHECK_REDIS=True
HEALTH_CHECK_EXTERNAL=True

# =============================================================================
# EXTERNAL SERVICES (Optional)
# =============================================================================

# Log aggregation
LOG_AGGREGATION_URL=https://your-log-aggregator.com
LOG_AGGREGATION_TOKEN=your-token

# Alert webhooks
ALERT_WEBHOOK_URL=https://your-alert-system.com/webhook

# =============================================================================
# APPLICATION SPECIFIC SETTINGS
# =============================================================================

# JWT settings
JWT_EXPIRATION_HOURS=24
JWT_REFRESH_EXPIRATION_DAYS=7

# File upload limits
MAX_UPLOAD_SIZE=10485760  # 10MB
FILE_UPLOAD_MAX_MEMORY_SIZE=10485760

# API rate limiting
API_RATE_LIMIT=1000/hour
API_BURST_LIMIT=100

# Pagination
DEFAULT_PAGE_SIZE=25
MAX_PAGE_SIZE=100

# =============================================================================
# DEPLOYMENT CONTROL
# =============================================================================

# Skip backup during deployment (not recommended for production)
SKIP_BACKUP=False

# Skip cleanup during deployment
SKIP_CLEANUP=False

# Deployment timeout (seconds)
DEPLOYMENT_TIMEOUT=600
